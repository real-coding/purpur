## Базовая настройка и основные команды

**Генерация открытого SSH-ключа**

*Если уже есть SSH-ключ ,то пропускаем 1-ый шаг*
1. ```ssh-keygen -t rsa``` (На все вопросы нажимем **Enter**)
2. ```pbcopy < ~/.ssh/id_rsa.pub``` (Скопирует **key** в буффер)

**Настройка SSH**
1. Заходим в **Settings** своего профиля в github
2. Выбираем вкладку **SSH keys**
3. Нажимаем **New SSH key**
4. В **Key** всталяем ключ из буффера ,в **Title** произвольное название

*Соединение через SSH позволит не вводить каждый раз пароль для подключения к удаленному репозиторию*

**Скачивание репозитория и установка параметров юзера**

1. В терминале переходим в папку ,куда хотим поставить проект
2. Вводим ```git@github.com:real-coding/purpur.git```
3. Переходим в проект ```cd purpur```
4. ```git config user.name "<Ваше имя как в smartprogress>"```
5. ```git config user.email <Email с которым регались на github>```

*Последние 2 команды установят локально для проекта параметры пользователя в репозитории. Важно ,чтобы имя пользователя совпадало с именем пользователя на Smartprogress для быстрой идентификации*

## Описание Gitflow

**Работа над задачей**

1. Обязательно актуализируем ветку *master* перед работой ```git pull origin master```
2. Создаем новую ветку с названием согласно номеру Issue по следующему шаблону ```issue#<Номер Issue>```
3. Стараемся не делать все в одном коммите ,а разрабатывать свою задачу итеративно ,сохраняясь коммитами. Формат коммитов следующий: ```Issue#<Номер Issue>: <Что было сделано коротко в 3-6 словах>```
4. Как только закончили задачу ,проверяем на наличие лишнего кода (```console.log``` и прочее).
5. Проверяем так же работоспособность реализованного функционала.
6. Проверяем ,чтобы в консоли не было ошибок ,а так же ошибок и варнингов (eslint, csslint) при сборке
7. Как только убедились ,что все ок ,актуализируем теги ```git fetch --tags```
8. Запускаем ```npm version prerelease``` для инкремента новой версии с постфиксом
9. Пушим на удаленный репозиторий ```git push -u origin <Название вашей ветки> --follow-tags```
10. Заходим на github в раздел **Pull requests** и создаем пуллреквест **New pull request**
11. В качестве **base** должна быть ветка master. В качестве **Compare** выбираем свою из списка
12. Нажимаем **Create pull request**

*Зачем нужен ```git fetch --tags``` и ```npm version prerelease```? В общем каждая реализация (будь это задача или хотфикс) должна контролироваться версией. Это необходимо для лучшего контроля над сборками продукта и возможностью быстрого отката к той или иной версии ,а так же поможет нам в будущем настроить грамотный CD для тестов и релизов.*
*```prerelease``` берет текущую версию из package.json и создает новый патч с постфиксом пререлизной стадии ,например 1.0.1-0. Далее после одобрения ревью и мержа делается ```patch``` ,который утверждает версию - 1.0.1 ,однако в ходе правок после кодревью могут образовываться новые стадии этого патча - 1.0.1-1, 1.0.1-2 и т.д.*
*Как правило полная реализации какой-то новой бизнес-истории сопровождается минорным инкрементом. А глобальные изменения в продукте - мажорным.*
*При пуше могут быть конфликты версий (git скажет что тег ,который мы хотим отправить ,уже существует). В таком случае повышаем патч своей версии ```npm version patch``` и снова делаем ```npm version prerelease```*
*Если перед пушем сделать фетч тегов ,то можно избежать ситуации с конфликтом тегов ,сверив свой локальный тег версии с тегами на удаленном репозитории. Если дубликата нет ,то смело пушим. Если есть ,то повышаем патч и снова пререлиз.*

***Поскольку у нас монорепозиторий ,то версии бека и фронта синхронизированы (имеют один общий package.json для версионности).***

## Политика PR REVIEW

1. Для PR открытых в ветку master обязательными аппруверами назначаются - Никита и Алексей. Т.е. либо апрув одного ,либо другого обязателен перед мержем. В идеале оба.
2. Code Review рекомендуется делать всем ,это так же принесет много опыта ,особенно если разберетесь в коде PR и будете понимать что там происходит
3. В будущем мы возможно напишем слэк-бота ,но пока хорошей праткикой будет сообщать об открытии пуллреквеста в канал **purpur-codereview**
4. Ветки ,не синхронизированные с мастером необходимо синхронизировать. Об этом сообщится на странице вашего PR ,если там будут конфликты ,которые невозможно разрезолвить автоматически
